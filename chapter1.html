<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 1 Analytics and sports business strategy | Fundamentals of Sports Business Analytics and Strategy</title>
<meta name="author" content="Justin Watkins">
<meta name="generator" content="bookdown 0.28 with bs4_book()">
<meta property="og:title" content="Chapter 1 Analytics and sports business strategy | Fundamentals of Sports Business Analytics and Strategy">
<meta property="og:type" content="book">
<meta property="og:url" content="https://justin-watkins.github.io/chapter1.html">
<meta property="og:image" content="https://justin-watkins.github.io/images/cover.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 1 Analytics and sports business strategy | Fundamentals of Sports Business Analytics and Strategy">
<meta name="twitter:image" content="https://justin-watkins.github.io/images/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Prompt-0.4.4/font.css" rel="stylesheet">
<link href="libs/JetBrains_Mono-0.4.4/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.4.1/transition.js"></script><script src="libs/bs3compat-0.4.1/tabs.js"></script><script src="libs/bs3compat-0.4.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
<meta name="description" content="This chapter will give you some background on my ideologies around analytics and sports business at the club level. I also want to separate the disciplines of strategy and analytics a little....">
<meta property="og:description" content="This chapter will give you some background on my ideologies around analytics and sports business at the club level. I also want to separate the disciplines of strategy and analytics a little....">
<meta name="twitter:description" content="This chapter will give you some background on my ideologies around analytics and sports business at the club level. I also want to separate the disciplines of strategy and analytics a little....">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Fundamentals of Sports Business Analytics and Strategy</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Abstract and forward</a></li>
<li><a class="active" href="chapter1.html"><span class="header-section-number">1</span> Analytics and sports business strategy</a></li>
<li><a class="" href="chapter2.html"><span class="header-section-number">2</span> Constructing our data sets</a></li>
<li><a class="" href="chapter3.html"><span class="header-section-number">3</span> Exploring your data</a></li>
<li><a class="" href="chapter4.html"><span class="header-section-number">4</span> Structuring analytics projects</a></li>
<li><a class="" href="chapter5.html"><span class="header-section-number">5</span> Segmentation</a></li>
<li><a class="" href="chapter6.html"><span class="header-section-number">6</span> Forcasting Sales and Setting Prices</a></li>
<li><a class="" href="chapter7.html"><span class="header-section-number">7</span> Lead Scoring</a></li>
<li><a class="" href="chapter8.html"><span class="header-section-number">8</span> Marketing promotions</a></li>
<li><a class="" href="chapter9.html"><span class="header-section-number">9</span> Consumer Research</a></li>
<li><a class="" href="chapter10.html"><span class="header-section-number">10</span> Operations and Analytics</a></li>
<li><a class="" href="Chapter11.html"><span class="header-section-number">11</span> Epilogue</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/Justin-Watkins/Justin-Watkins.github.io">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="chapter1" class="section level1" number="1">
<h1>
<span class="header-section-number">1</span> Analytics and sports business strategy<a class="anchor" aria-label="anchor" href="#chapter1"><i class="fas fa-link"></i></a>
</h1>
<p>This chapter will give you some background on my ideologies around analytics and sports business at the club level. I also want to separate the disciplines of strategy and analytics a little. Analytics serves strategy, but strategy is derived from analytics. This chapter will outline some of our biases and explain our approach. There are often many ways to approach a problem and some problems may not be worth solving for any number of reasons. Despite some inherent difficulties with sports, an analytic approach to problem solving should always be at the core of your business strategy.</p>
<p>Analytics is about reconciling opportunities and it is inextricably bound to business strategy. Many of the problems that we face are very old and have not yet been solved. This is especially true for Operations. I am convinced that there are unlimited applications for analytics within any industry or business. We should all demand objective justification for any value-statements not bound to empirical evidence. Our assertions must be tempered by the rigor of sound judgment and thoughtful analysis. Demand nothing less when outlining a strategy with colleagues.</p>
<p>Additionally, analytics can take many forms and could improve decision making in many functions that we have already mentioned:</p>
<ul>
<li>Marketing: marketing mix, brand strategy, content, CRM, and pricing</li>
<li>Business Intelligence: descriptive and prescriptive reporting</li>
<li>Finance: capital expenditure, and forecasting, corporate finance</li>
<li>Sales: lead scoring, sales strategy, customer journey mapping</li>
<li>Sponsorship: asset valuation, asset creation</li>
<li>Operations: ingress and egress, staffing, concessions</li>
<li>Technology: supporting these systems</li>
</ul>
<p>Analytics can even assist in tasks outside of core business functions such as human resources. For instance, you can optimize staffing or compensation packages. It can also mean so many different things. Ad hoc analytic tasks typically involve nothing more than a simple spreadsheet that organizes the data. Techniques and application are varied and may include a number of disciplines:</p>
<ul>
<li>Segmentation</li>
<li>Simulation</li>
<li>Statistics</li>
<li>Optimization</li>
<li>Cognitive Science and behavioral economics</li>
<li>Programming</li>
<li>Designing experiments (DOE)</li>
</ul>
<p>These lists could be endlessly long. <em>Versatility</em> is the hallmark of the analyst and strategist. You aren’t going to find many books on general strategy. Strategy is an amalgam of knowledge focused on specific problems. People who are good at it understand the business at a fundamental level and understand how to structure problems so that they may be solved in intelligent ways. The strategist is never quixotic. The strategist looks to the future, but understands the past. The strategist provides a concise reasoning for a course of action. You are forging an alloy that will increase profitability while making your business more efficient and resilient. You may be hated for it. Ignore the criticism.</p>
<div id="understanding-the-meaning-of-strategy" class="section level2" number="1.1">
<h2>
<span class="header-section-number">1.1</span> Understanding the meaning of strategy<a class="anchor" aria-label="anchor" href="#understanding-the-meaning-of-strategy"><i class="fas fa-link"></i></a>
</h2>
<p>Strategy is a complex term, but it can really be boiled down to having a plan. A strategy has a goal and that goal can vary. For instance, like most companies (especially public companies) driving firm valuations may be a goal. You typically drive valuation higher by increasing revenue or by reinforcing a strategic moat. For example, in the streaming wars Netflix, Disney, and others are in a race to produce content. Content is their strategic moat because the technology has essentially been commoditized while consumer behavior has shifted. They play in a highly competitive space and are in a dog fight with every other competitor.</p>
<p>I have often heard people describe strategy as turning everyone’s head in the right direction. I suppose that is a component of strategy. Strategy is about achieving your goals with a plan. Sometimes efficiency comes into play. Strategy can also be offensive or defensive and involve public relations or lobbying efforts. It can include manipulating market forces of supply and demand or structuring media rights deals. You can divest from under-performing assets or create entirely new asset classes. You can hedge against risks by diversifying your approach or through partnerships. This is a broad term that gets overused, is often confused for something else, and is simply an abstraction if it isn’t framed around specific goals.</p>
<p>Strategy is also about communication. This can’t be stressed enough. If you want to learn about strategy I suggest that you take a negotiations course. You can also read a couple of key books. “How to win friends and influence people” <span class="citation">(<a href="references.html#ref-Carnegie1981" role="doc-biblioref">Carnegie 1981</a>)</span> is a good place to start. This classic was written in the nineteen-thirties and is as relevant today as it was then. Another great book you should consider is “Getting To Yes, Negotiating Agreement Without Giving In” <span class="citation">(<a href="references.html#ref-Fisher2011" role="doc-biblioref">Roger Fisher 2011</a>)</span>. This book is all about positioning arguments. This is a critical skill set. If you can’t do this, you might as well not understand how addition works. Working with and understanding people, presentation skills, and understanding how to frame arguments without being condescending is critical to strategy. I can’t stress the importance of soft skills enough. This is the most important paragraph in this book.</p>
<p>From an academic standpoint, there are lot’s of strategic frameworks. Harvard’s Michael Porter descried firms as “a collection of activities that are performed to design, produce, market, deliver, and support products.” <span class="citation">(<a href="references.html#ref-Keller2003" role="doc-biblioref">Keller 2003</a>)</span> His most famous contribution to business strategy is likely “Porter’s five forces.” <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://en.wikipedia.org/wiki/Porter%27s_five_forces_analysis" class="uri"&gt;https://en.wikipedia.org/wiki/Porter%27s_five_forces_analysis&lt;/a&gt;&lt;/p&gt;'><sup>5</sup></a> What is interesting about this framework is that on the surface it doesn’t appear imminently useful to a sports team. Where it does come in useful is when thinking about strategic problems such as <em>What Point-Of-Sale system should we use throughout our venue?</em>. In that case, this model can be used to consider who you might select based on those market forces. Will there be consolidation, what does that mean, what is our most powerful position in terms of negotiating. If the product is a commodity, the vendor will have to compete on price. Perhaps they are interested in marketing and are candidates for a sponsorship. Maybe you could purchase the company. You can get creative.</p>
<p>This chapter will put additional context around analytics and strategy. We’ll look at some of the major functions of analytics and talk about how data is used to underpin these functions. I have a tendency to be cynical here. If you have ever messed around in the stock market you’ll here a lot of talk about <em>fundamentals</em>. The type of analysis you might find in a trading platform is the illusion of analysis. Applying techniques like <em>triple exponential smoothing</em><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://en.wikipedia.org/wiki/Exponential_smoothing" class="uri"&gt;https://en.wikipedia.org/wiki/Exponential_smoothing&lt;/a&gt;&lt;/p&gt;'><sup>6</sup></a> or <em>moving averages</em> to stocks is great. Does it make a novice a better trader? It might make them worse. Analysis is great if you understand it. It is contextual. If you don’t understand the context it can be misleading or damaging. Data is not the solution. Or maybe it is. It depends. Keep that in mind and think critically about the problems we are going to cover. The mechanical part of analysis isn’t the important part of it. It should be a commodity. Focus on the application and communication.</p>
</div>
<div id="technologies-place-in-strategy-and-analytics" class="section level2" number="1.2">
<h2>
<span class="header-section-number">1.2</span> Technologies place in strategy and analytics<a class="anchor" aria-label="anchor" href="#technologies-place-in-strategy-and-analytics"><i class="fas fa-link"></i></a>
</h2>
<p>I consider the application of technology in analytics along five ordered dimensions. While you can jump around to a degree, each step is generally built on the step below it. As you ascend the steps, execution tends to become more difficult and complex. Execution is where your strategy will fall apart. Read that last sentence again. Additionally, your strategy should to flow from the top down. This means you keep your destination in mind as you move up each of your steps.</p>
<p>As ridiculous as it may sound, you have to begin with data structure. You are building an engine and you have to have all of the correct parts. Data is invariably messy. So much effort goes into cleaning, structuring, and storing data for use that it represents the bulk of time spent across the spectrum of analytics. You must begin there. Additionally, there are probably multiple levels of maturity on this front. For instance, ticketing data may be very well structured while CRM data may be lacking. I view analytics within the structure proposed in figure <a href="chapter1.html#fig:choneheirarh">1.1</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:choneheirarh"></span>
<img src="images/CH1_ML_Heirarchy.png" alt="Data strategy heirarchy of needs" width="100%"><p class="caption">
Figure 1.1: Data strategy heirarchy of needs
</p>
</div>
<p>Furthermore, I consider technology to be “a means to an end,” and not “an end unto itself.” This tends to be a common confusion. Your technology strategy should flow from a well-articulated business strategy. For instance, you could spend capital to allow fans to enter a park leveraging facial recognition, but what problem does that solve? Is scanning a ticket the bottleneck in that system that slows down the process? Do fans want it? Does the regulatory environment permit it? This sounds like a complex system more than a camera and a database. While innovation is sometimes bred by throwing something at the wall to see if it sticks, I haven’t found that to be the primary vehicle for technology adoption. When an organization takes a misguided technology-first approach, I have found the results to be painfully unremarkable. Determine what you want to accomplish and why you want to accomplish it before deploying a technology solution.</p>
<p>Perhaps you want to <em>revolutionize</em> your business. Very few problems are solved in revolutionary ways. The internet feels much the same as it did twenty years ago. We are now talking about web 3.0 and the metaverse. We already have a <em>metaverse</em>. It is called the internet. It isn’t revolutionary. What it really represents is a platform that big tech wants you to use to transact. Maybe it will be a better way of doing things or maybe it is simply a worse way of doing everything. The jury will be out for the next decade. In that sense perhaps it is 3D television. Remember those? Of course you don’t. Look for the business model that underlies these marketing schemes. If you understand the mechanism, you’ll be able to plan for what comes next.</p>
<p>We don’t want to be disparaging toward Information Technology. Strong I.T. skill sets are incredibly useful. As your skills progress you’ll be exposed to a myriad of technologies:</p>
<ul>
<li>if you work on Windows or Apple, you’ll still need some understanding of Linux<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://www.linux.org/" class="uri"&gt;https://www.linux.org/&lt;/a&gt;&lt;/p&gt;'><sup>7</sup></a>
</li>
<li>Shell scripting is a critical skill for any dev-ops task<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://en.wikipedia.org/wiki/Bash_(Unix_shell)" class="uri"&gt;https://en.wikipedia.org/wiki/Bash_(Unix_shell)&lt;/a&gt;&lt;/p&gt;'><sup>8</sup></a>
</li>
<li>Start using git as a repository for your code&amp;<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://github.com/" class="uri"&gt;https://github.com/&lt;/a&gt;&lt;/p&gt;'><sup>9</sup></a>
</li>
<li>Tools such as <em>docker</em> allow you to package programs if you are doing web development<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://www.docker.com/" class="uri"&gt;https://www.docker.com/&lt;/a&gt;&lt;/p&gt;'><sup>10</sup></a>
</li>
<li>You don’t need your own server. Google, Amazon, and Microsoft each have massive deployment platforms.</li>
</ul>
<p>Don’t shy away from spending the time to get familiar with these technology components. You’ll be rewarded for it.</p>
<p>The main difference between the internet today and twenty years ago is that people mostly use a phone to access and browse it. Incremental improvements over time tends to be the way changes take place. Core business procedures can always be improved. Most people that are rich didn’t get there through some brilliant product or idea. They just did the same things other rich people did and they executed properly. Think of analytics and business strategy in the same way. We’ll walk through each component in figure <a href="chapter1.html#fig:choneheirarh">1.1</a> and discuss it in more detail.</p>
<div id="data" class="section level3" number="1.2.1">
<h3>
<span class="header-section-number">1.2.1</span> Data<a class="anchor" aria-label="anchor" href="#data"><i class="fas fa-link"></i></a>
</h3>
<p>Getting the foundational elements of data in place is critical to all other components of the hierarchy. There is a lot to consider here. While we won’t discus <em>Master Data Management</em> or specific technologies such as <em>Customer Data Platforms</em>, we will talk about the foundations of data and what we mean when we use the word. Most organizations have solved portions of their data management, but it’s a never-ending problem. There will always be newer and better systems and there will always be a need to incorporate new data into your sales and marketing infrastructure. This process is accelerating as Google, Amazon, and others vie to own the cloud. Amazon Web Services and the Google Cloud Platform are disruptive in the sense that they can deliver capabilities that would be financially unfeasible for many firms trying to build them in house. The on-prem DBMS will slowly go extinct<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;This isn’t quite true. There are certain instances where having a captive instance is useful or necessary&lt;/p&gt;"><sup>11</sup></a>. This is also an old battle. If this was twenty five years ago our discussion may have been on Thin-client vs. Fat-Client computing.</p>
<p>Let’s go ahead an make the assumption that your sports team doesn’t have their data in a perfect spot. Getting your data in a useful position may take a number of varied techniques and has its own considerations:</p>
<ul>
<li>What systems are the most important to incorporate?</li>
<li>Is the data “Big,” meaning is it an engineering challenge to hold the data or does its velocity necessitate a special approach?</li>
<li>How and where will it be housed?</li>
<li>Who manages this process (internal, partner, etc)?</li>
<li>How much will this cost?</li>
<li>Do we have the necessary skill sets to accomplish our goals?</li>
<li>Who understands and manages the data structure?</li>
</ul>
<p>Another important consideration is what you plan on doing with your data. How can it be used? This could dictate your approach to making it available and how your ETL (Extract, Transform, and Load) procedures work. For instance, do you need your data to be available at all times and does it need to be current? What does <em>current</em> mean? Latency may not be that important. Indeed, it isn’t in most situations in sports. twenty four hours is probably enough. Many data points may only be considered on certain intervals. This gives you some indication of how to prioritize your tasks. Let’s illustrate the problem.</p>
<div id="understanding-data-structures" class="section level4" number="1.2.1.1">
<h4>
<span class="header-section-number">1.2.1.1</span> Understanding data structures<a class="anchor" aria-label="anchor" href="#understanding-data-structures"><i class="fas fa-link"></i></a>
</h4>
<p>You’ll encounter numerous data structures working in sports, but none are more important than the ticketing system. Regardless of the vendor (TicketMaster is probably the most common), you’ll encounter some form the following ERD <a href="chapter1.html#fig:chonedataticketing">1.2</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:chonedataticketing"></span>
<img src="images/CH1_ML_Decision_ticket_structure.png" alt="Ticketing system data structure" width="100%"><p class="caption">
Figure 1.2: Ticketing system data structure
</p>
</div>
<p>What are we looking at? While there are many different database systems <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://en.wikipedia.org/wiki/Database" class="uri"&gt;https://en.wikipedia.org/wiki/Database&lt;/a&gt;&lt;/p&gt;'><sup>12</sup></a> available, the venerable relational database is the one you will encounter the most. AWS and Google have improved and optimized some of these models, but the basic concept is going to look familiar across most platforms. We’ll ignore even high-level discourse of the technical parts of database construction such as <em>cardinality</em> and <em>normal forms</em> and discuss this stuff through examples.</p>
<p>Think of a database as a collection of excel workbooks that are formally linked with an ID column. We’ll call these workbooks tables. These tables will allow you to get information on transactions, historical purchase data, customer service rep data, ticketing information, and more. You can read the “crow’s-foot” as “Many”, the cross as “one.” For example, one customer can have many plans.These relationships can be much more complicated, but at a basic level data that you encounter will look something like this. if the database is relational (More than likely), basic SQL statements can be used to retrieve your information:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb1-1"><a href="chapter1.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">------------------------------------------------------------------</span></span>
<span id="cb1-2"><a href="chapter1.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- SQL example</span></span>
<span id="cb1-3"><a href="chapter1.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">------------------------------------------------------------------</span></span>
<span id="cb1-4"><a href="chapter1.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  A.customer_id</span>
<span id="cb1-5"><a href="chapter1.html#cb1-5" aria-hidden="true" tabindex="-1"></a>       ,A.email_addr</span>
<span id="cb1-6"><a href="chapter1.html#cb1-6" aria-hidden="true" tabindex="-1"></a>       ,B.plan_id</span>
<span id="cb1-7"><a href="chapter1.html#cb1-7" aria-hidden="true" tabindex="-1"></a>       ,B.price</span>
<span id="cb1-8"><a href="chapter1.html#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> Customer A <span class="kw">LEFT</span> <span class="kw">JOIN</span> Plans B <span class="kw">ON</span> A.customer_id <span class="op">=</span> B.customer_id</span>
<span id="cb1-9"><a href="chapter1.html#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> A.email_addr <span class="op">=</span> <span class="ot">"Ted.Williams@someserver.com"</span></span></code></pre></div>
<p>The output from this query might look something like this:</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="center">customer_id</th>
<th align="center">email_addr</th>
<th align="center">plan_id</th>
<th align="center">price</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1940-2349-1243</td>
<td align="center">Ted.Williams@someserver.com</td>
<td align="center">23454</td>
<td align="center">1094.00</td>
</tr>
<tr class="even">
<td align="center">1940-2349-1243</td>
<td align="center">Ted.Williams@someserver.com</td>
<td align="center">23455</td>
<td align="center">3200.00</td>
</tr>
<tr class="odd">
<td align="center">1959-9909-4567</td>
<td align="center">Ted.Williams@someserver.com</td>
<td align="center">61545</td>
<td align="center">2500.00</td>
</tr>
</tbody>
</table></div>
<p>For some reason I am afraid to type SQL that isn’t in all caps. I don’t know why, but it isn’t case sensitive and it doesn’t matter. While the data will be more complex, this example is here to demonstrate the problems you will face (if they haven’t been solved) and how these problems force you to think strategically. As you can see, it appears that Ted has multiple accounts.</p>
<p>Let’s take a quick aside to discuss <em>Structured Query Language</em>, or SQL. SQL is the <em>lingua-Franca</em> of the database world. Although there are many technologies that use “Not Only” SQL, you’ll get the most mileage from SQL and it is a prerequisite if you want to work with data in almost any capacity. The good news is that it is relatively simple to learn at a basic level and functional fluency can be achieved relatively easily. There are also plenty of free resources available to learn an practice it. W3 schools is an excellent one. <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://www.w3schools.com/" class="uri"&gt;https://www.w3schools.com/&lt;/a&gt;&lt;/p&gt;'><sup>13</sup></a></p>
<p>The integration between the CRM and ticketing systems is incredibly important. There are many considerations:</p>
<ul>
<li>How will the ETL be constructed? API, direct database connection, etc.</li>
<li>How are parity checks considered?</li>
</ul>
<p>These are all heavy I.T. tasks. Although the end-product will be the most important component to an analyst, understanding how some of this stuff works is important. It will make you better.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:chonedatacrm"></span>
<img src="images/CH1_ML_Decision_crm_structure.png" alt="CRM system data structure" width="100%"><p class="caption">
Figure 1.3: CRM system data structure
</p>
</div>
<p>The data in figure <a href="chapter1.html#fig:chonedatacrm">1.3</a> look a little different. Different CRM systems may also have different ways of querying the data. Salesforce uses SOQL which looks similar sql, but it forces you to traverse relationships a little differently. Let’s take a look at the data.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb2-1"><a href="chapter1.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">------------------------------------------------------------------</span></span>
<span id="cb2-2"><a href="chapter1.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- SQL example example</span></span>
<span id="cb2-3"><a href="chapter1.html#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">------------------------------------------------------------------</span></span>
<span id="cb2-4"><a href="chapter1.html#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  A.customer_id</span>
<span id="cb2-5"><a href="chapter1.html#cb2-5" aria-hidden="true" tabindex="-1"></a>       ,A.ticketing_system_id</span>
<span id="cb2-6"><a href="chapter1.html#cb2-6" aria-hidden="true" tabindex="-1"></a>       ,B.deal_id</span>
<span id="cb2-7"><a href="chapter1.html#cb2-7" aria-hidden="true" tabindex="-1"></a>       ,C.opportunity_id</span>
<span id="cb2-8"><a href="chapter1.html#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> Customer A <span class="kw">LEFT</span> <span class="kw">JOIN</span> deal B <span class="kw">ON</span> A.customer_id <span class="op">=</span> B.customer_id</span>
<span id="cb2-9"><a href="chapter1.html#cb2-9" aria-hidden="true" tabindex="-1"></a>                <span class="kw">LEFT</span> <span class="kw">JOIN</span> opportunity C <span class="kw">ON</span> B.deal_id <span class="op">=</span> C.deal_id</span>
<span id="cb2-10"><a href="chapter1.html#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> A.email_addr <span class="op">=</span> <span class="ot">"Ted.Williams@someserver.com"</span></span></code></pre></div>
<p>This data might begin to look confusing because the relationships are a little more complex.</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="center">customer_id</th>
<th align="center">ticketing_system_id</th>
<th align="center">deal_id</th>
<th align="center">opportunity_id</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">l993w-233e-653r-88jg</td>
<td align="center">1940-2349-1243</td>
<td align="center">1234</td>
<td align="center">q23w-234e-654r-678g</td>
</tr>
<tr class="even">
<td align="center">l993w-233e-653r-88jg</td>
<td align="center">1940-2349-1243</td>
<td align="center">1234</td>
<td align="center">t567-3f45-6h78-234u</td>
</tr>
<tr class="odd">
<td align="center">pp3w-232e-k54r-ww3b</td>
<td align="center">1959-9909-4567</td>
<td align="center">3245</td>
<td align="center">y567-3f25-6h78-234p</td>
</tr>
</tbody>
</table></div>
<p>What do we have here? It appears that Mr. Williams has created (or had created) more than one account and the accounts are not merged into one. This is a simple example, but it demonstrates a duplication problem that is constantly faced. I am going to guess that we have one Ted Williams, but the system is regarding him as two people. Business rules can mitigate some of these issues. For instance, the ticketing system could forbid users from using an email that is already in the system. While sing email_address as a primary key does have some advantages, there are always downstream issues that you have to consider. Nothing is perfect. Someone may simply use a different email. Then you have one person, but it may be impossible to tell them apart.</p>
<p>Garbage-in, garbage-out. Without getting this data clean, you won’t be able to effectively move to the next level of our hierarchy.</p>
</div>
</div>
<div id="business-intelligence" class="section level3" number="1.2.2">
<h3>
<span class="header-section-number">1.2.2</span> Business Intelligence<a class="anchor" aria-label="anchor" href="#business-intelligence"><i class="fas fa-link"></i></a>
</h3>
<p>Business Intelligence is a loaded phrase and can mean many different things. Enabling a B.I. capability is possible once you’ve established some good data structure. This portion of the chapter will discuss B.I. at a high level and discuss some of the differences in data structure that enables more sophisticated reporting.</p>
<p>I usually place it under two categories:</p>
<ul>
<li>Reporting</li>
<li>Research</li>
</ul>
<p>A component of Customer Relationship Management (CRM) also falls under this umbrella in practice at clubs. There are many reasons for this, the biggest is simply legacy. Another reason is that the CRM system typically houses much of the data that may be used for reporting. It’s a natural match. Reporting systems such as Tableau, Qlik, Looker, Business Objects, etc. depend on having well structured data. Be cautions on tools as well. You can easily abuse them and not get the results you are looking for. Once you have your data in a good spot you are ready to tell people about it. Gathering insight from your data can take many forms, but it is often placed in one of four categories seen in figure <a href="chapter1.html#fig:chonedatabi">1.4</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:chonedatabi"></span>
<img src="images/CH1_BI_Insight.png" alt="Four categories of reporting" width="100%"><p class="caption">
Figure 1.4: Four categories of reporting
</p>
</div>
<p>The first stop is reactive reporting <em>Description</em> and <em>Diagnosis</em>. Once you have your data structured appropriately, you’ll be able to produce backwards looking reports. These reports are likely the bread-and-butter of a Business Intelligence department. You are answering questions about how much a rep sold, or how many tickets were sold during a specific time frame.</p>
<p><em>Prediction</em> and <em>Perscription</em> are forward looking. For instance, you might integrate predictive models into your reporting that indicate whether or not sales goals are likely to be met. We’ll talk about how that might be accomplished in the next section. <em>Prescriptive</em> reports might tell you what you should do about a problem once it has been diagnosed. In our context, a prescriptive report might enable a manager to reroute marketing dollars to more efficient channels. For instance, the report could identify diminishing returns on marketing spend through a particular social channel and suggest one with demonstrably greater success.</p>
<div id="business-intelligence-data-structure" class="section level4" number="1.2.2.1">
<h4>
<span class="header-section-number">1.2.2.1</span> Business Intelligence data structure<a class="anchor" aria-label="anchor" href="#business-intelligence-data-structure"><i class="fas fa-link"></i></a>
</h4>
<p>Data structure for a BI system doesn’t necessarily have to be any different than what you may find in a typical relational database. You can plug a system such as Tableau <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://www.tableau.com/" class="uri"&gt;https://www.tableau.com/&lt;/a&gt;&lt;/p&gt;'><sup>14</sup></a> into your database and likely get some good capability. However, in practice the data is usually restructured into facts and dimensions. Additionally, data structures can also take more complex forms such as data cubes <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://en.wikipedia.org/wiki/Data_cube" class="uri"&gt;https://en.wikipedia.org/wiki/Data_cube&lt;/a&gt;&lt;/p&gt;'><sup>15</sup></a>, JSON-like hierarchical data, or other more exotic forms that can handle array-like data within specific database fields. We’ll focus on the simple fact and dimension.</p>
<p>You can think of a <em>fact</em> as something that will be aggregated. It is a number. <em>Dimensions</em> are the features that you use to understand your numbers. Consider the diagram in figure <a href="chapter1.html#fig:chonedatafanddim">1.5</a>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:chonedatafanddim"></span>
<img src="images/facts_dimensions.png" alt="CRM system data structure" width="100%"><p class="caption">
Figure 1.5: CRM system data structure
</p>
</div>
<p>These tables don’t look much different than what you saw in figure <a href="chapter1.html#fig:chonedatacrm">1.3</a>. The main difference is conceptual. In the earlier diagram no tables were necessarily prioritized over others. You might look at the tables and consider the customer as the central table with features radiating out from that specific customer. The customer has a rep, purchases tickets, may have a plan, etc. In this diagram the <em>Ticket</em> is central. Since B.I. tools are at heart aggregation machines, this structure is extremely important. If you want to perform some math on a feature such as ticket price, you put it in the fact table. This allows you to perfromantly answer all kinds of questions such as:</p>
<ul>
<li>How much did customer A spend on tickets in 2018?</li>
<li>How much was spend on tickets in 2021?</li>
<li>How many customers does rep A have and how much did they spend in 2019?</li>
</ul>
<p>As a rule, I tend to like to structure the data the way I would want it within the database. While this isn’t always feasible or efficient, it does have some advantages. It can be efficient because flattening the relationships into fewer tables can make your software run more quickly. You have removed the need to traverse a relationship. It also means that you are less dependent on learning all the capabilities of the B.I. platform. It makes things simpler from that perspective. This tends to work well when the person doing the B.I. work is also the data engineer. The problem is that it isn’t as scaleable and can get confusing. It might even lead you to build custom systems where you aren’t constrained in the same ways.</p>
<p>There are also some pitfalls that you should be aware of. You can sometimes work around these issues. However, you can also run into problems with Cartesian joins <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://en.wikipedia.org/wiki/Cartesian_product" class="uri"&gt;https://en.wikipedia.org/wiki/Cartesian_product&lt;/a&gt;&lt;/p&gt;'><sup>16</sup></a>. This means that you can double-count a value if you aren’t careful. This is common if you have constructed a snowflake schema for your facts and dimensions tables.</p>
</div>
</div>
<div id="analytics" class="section level3" number="1.2.3">
<h3>
<span class="header-section-number">1.2.3</span> Analytics<a class="anchor" aria-label="anchor" href="#analytics"><i class="fas fa-link"></i></a>
</h3>
<p>The term analytics is at least as broad as business intelligence. In our context, I distinguish it from business intelligence because it is less concerned with displaying information and more concerned with interpretation. Additionally, it is usually easier to get your base B.I. functionality running than to begin applying analytic techniques to your data. Ultimately, business intelligence and analytics are going to work together and form the backbone of your (antiquated but valid term) decision support systems.</p>
<p>Analytics refers to applying some operation to your data and gaining some additional insight from that modification. Obviously, getting data structured appropriately is critical. I typically put analytics tools into one of two categories:</p>
<ul>
<li>Regression</li>
<li>Machine learning</li>
</ul>
<p>Let’s take a minute to explain these terms. There is definitely some overlap. Analytics is a muddy term. You may or may not be familiar with regression. Regression can get very technical and performing regression analysis tends to be dogmatic and rigorous. We’ll make heavy use of it and you will need to understand how it works. I recommend getting a reference book on the subject. There are many. My favorite is “An R Companion to Applied Regression.” <span class="citation">(<a href="references.html#ref-Fox2019" role="doc-biblioref">John Fox 2019</a>)</span> Let’s try to do a quick explanation of <em>ordinary least squares</em> regression to demonstrate its power. We are going to build this explanation in R, but will resist showing you actual code until the next chapter.</p>
<p>I am going to explain regression here in the simplest way possible. I am not a mathematician and you don’t have to be one to leverage regression. Also, we aren’t working with clinical trials of a drug. We are working with fuzzy business problems. Exacting rigor simply isn’t as necessary. The following section will take you through a simple explanation of one form of regression and explain the way I like to think about it.</p>
<div id="regression" class="section level4" number="1.2.3.1">
<h4>
<span class="header-section-number">1.2.3.1</span> Regression<a class="anchor" aria-label="anchor" href="#regression"><i class="fas fa-link"></i></a>
</h4>
<p>Consider the following meme I created on an online meme generator:</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:stupidmeme"></span>
<img src="images/linear_regression.jpg" alt="Your future thoughts on regression" width="100%"><p class="caption">
Figure 1.6: Your future thoughts on regression
</p>
</div>
<p>This is an incredibly reductive statement. Obviously you can’t use linear regression for generative art or computer vision. However, you are going to use it a lot and it has lots of advantages. Make sure you understand it. Eventually, you will agree with the meme. The following section explains how I like to think about it.</p>
<p>The familiar linear equation takes the form:</p>
<p><span class="math display">\[\begin{equation}
\ {y} = {m}{x} + {b}
\end{equation}\]</span></p>
<p>In this equation the Y is explained by x where m is equal to the slope of the line and b is equal to the y intercept. If we apply a list of x values (-5,-4,-3,-2,-1,0,1,2,3,4,5) to a linear equation with slope 2 and y-intercept of 5 we will get the graph in figure <a href="chapter1.html#fig:regressbb">1.7</a>.</p>
<p><span class="math display">\[\begin{equation}
\ {y} = {2}{x} + {5}
\end{equation}\]</span></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:regressbb"></span>
<img src="images/ch01_lin_equ.png" alt="Output of our linear equation" width="100%"><p class="caption">
Figure 1.7: Output of our linear equation
</p>
</div>
<p>In practice, your data points will most likely not fit a perfect linear equation. Regression is looking for the line through these points that minimizes the <em>sum of squared errors</em> (see figure <a href="chapter1.html#fig:regresscc">1.8</a>. The sum of squared errors represents ( <em>SSE</em> ) the distance between each point and the line. Look up the word <em>orthogonal</em> to see how this can vary. You square the errors so that negative numbers don’t impact the results.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:regresscc"></span>
<img src="images/ch01_lin_equ_two.png" alt="Output of our linear equation" width="100%"><p class="caption">
Figure 1.8: Output of our linear equation
</p>
</div>
<p>In multiple linear regression we are simply switching the linear equation around and add terms:</p>
<p><span class="math display">\[\begin{equation}
\ {y} = {b} + {m_1}{x_1} + {m_2}{x_2}
\end{equation}\]</span></p>
<p>The actual form is typically denoted similarly to the following equation:</p>
<p><span class="math display">\[\begin{equation}
\ \hat{y} = \alpha + \beta_1 x_1 + \beta_2 x_2 + \epsilon
\end{equation}\]</span></p>
<p>“The idea is to express the class as a linear combination of the attributes with predetermined weights.” <span class="citation">(<a href="references.html#ref-Witten2011" role="doc-biblioref">Ian H. Witten 2011</a>)</span> I just think about it as finding the best <em>average</em> line through your data where x explains y. The standard error represents a normal distribution that is split by the line. Once again, I don’t want to push reading too much, but I would highly recommend picking up any book on statistics or Googling multiple-linear-regression if you aren’t familiar with it. You’ll use it a lot as an analyst. Additionally, familiarize yourself with the different forms of regression. Orthoganal, Poissan, Ridge, etc. There are lots of problems that can be solved if you apply the correct technique.</p>
<p>That is as deep as I want to go here. We are going to use this tool a lot in subsequent chapters. I’d like to take the same simple approach to explaining Machine Learning.</p>
</div>
<div id="machine-learning" class="section level4" number="1.2.3.2">
<h4>
<span class="header-section-number">1.2.3.2</span> Machine Learning<a class="anchor" aria-label="anchor" href="#machine-learning"><i class="fas fa-link"></i></a>
</h4>
<p>Machine learning is a little different as a concept, but under the hood it is just statistics. This has been explained in many ways. At it’s heart, we are looking for patterns in data to make predictions.</p>
<p>There are three main types of machine learning:</p>
<ul>
<li>Unsupervised Learning</li>
<li>Supervised Learning</li>
<li>Reinforcement Learning</li>
</ul>
<p>Each of these variations are useful for solving different types of problems. We’ll cover them in more detail in subsequent chapters. Additionally, there to any of a number of techniques that fall under the machine learning umbrella including:</p>
<ul>
<li>Decision Trees</li>
<li>Random forests</li>
<li>Gradient boosting</li>
<li>Support vector machines</li>
<li>Neural networks</li>
</ul>
<p>You can also ensemble techniques. I typically explain machine learning through a basic explanation of a completed decision tree. An in-depth explanation of decision trees get’s mathy. This basic explanation comes from the book “Data Mining” <span class="citation">(<a href="references.html#ref-Witten2011" role="doc-biblioref">Ian H. Witten 2011</a>)</span>. This book utilizes a program called WEKA, but most or all of the concepts have implementations in R or Python.</p>
<p>We are going to begin looking at some of our data. You can install the FOSBASS library using the following command:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#-----------------------------------------------------------------</span></span>
<span><span class="co"># Install FOSBAAS Library</span></span>
<span><span class="co">#-----------------------------------------------------------------</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/">devtools</a></span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"Justin-Watkins/FOSBAAS"</span></span>
<span>                         ,ref<span class="op">=</span><span class="st">"master"</span></span>
<span>                         ,auth_token <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>A decision tree is simply an organized set of cascading questions and answers and are simple to understand at a high level. Let’s consider a simple data set:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#-----------------------------------------------------------------</span></span>
<span><span class="co"># Customer renewal data</span></span>
<span><span class="co">#-----------------------------------------------------------------</span></span>
<span><span class="va">renewal_data</span> <span class="op">&lt;-</span> <span class="fu">FOSBAAS</span><span class="fu">::</span><span class="va">customer_renewals</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:chonereneweddata">Table 1.1: </span>Renewal data set</caption>
<thead><tr class="header">
<th align="left">variable</th>
<th align="left">class</th>
<th align="left">first_values</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">accountID</td>
<td align="left">character</td>
<td align="left">WD6TDY7C151R, X3SB8ADEML22</td>
</tr>
<tr class="even">
<td align="left">corporate</td>
<td align="left">character</td>
<td align="left">i, c</td>
</tr>
<tr class="odd">
<td align="left">season</td>
<td align="left">double</td>
<td align="left">2021, 2021</td>
</tr>
<tr class="even">
<td align="left">planType</td>
<td align="left">character</td>
<td align="left">p, f</td>
</tr>
<tr class="odd">
<td align="left">ticketUsage</td>
<td align="left">double</td>
<td align="left">0.728026975947432, 0.992104738159105</td>
</tr>
<tr class="even">
<td align="left">tenure</td>
<td align="left">double</td>
<td align="left">2, 19</td>
</tr>
<tr class="odd">
<td align="left">spend</td>
<td align="left">double</td>
<td align="left">4908, 16410</td>
</tr>
<tr class="even">
<td align="left">tickets</td>
<td align="left">double</td>
<td align="left">6, 2</td>
</tr>
<tr class="odd">
<td align="left">distance</td>
<td align="left">double</td>
<td align="left">61.6614648674555, 19.5341155295423</td>
</tr>
<tr class="even">
<td align="left">renewed</td>
<td align="left">character</td>
<td align="left">nr, nr</td>
</tr>
</tbody>
</table></div>
<p>We’ll see this data several times through the book. Basically, it is just a number of factors and a column that states whether the fan renewed season tickets of not. Let’s apply a decision tree to the data. We’ll only look at one factor, distance. For this example we used two libraries: rpart <span class="citation">(<a href="references.html#ref-R-rpart" role="doc-biblioref">Therneau and Atkinson 2022</a>)</span> and rpart.plot <span class="citation">(<a href="references.html#ref-R-rpart.plot" role="doc-biblioref">Milborrow 2022</a>)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#-----------------------------------------------------------------</span></span>
<span><span class="co"># Customer renewal data</span></span>
<span><span class="co">#-----------------------------------------------------------------</span></span>
<span><span class="va">d_tree</span> <span class="op">&lt;-</span> </span>
<span><span class="fu">rpart</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html">rpart</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">renewed</span> <span class="op">~</span> <span class="va">distance</span>, </span>
<span>             method  <span class="op">=</span> <span class="st">"class"</span>,</span>
<span>             data    <span class="op">=</span> <span class="va">renewal_data</span><span class="op">)</span></span>
<span><span class="fu">rpart.plot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rpart.plot/man/rpart.plot.html">rpart.plot</a></span><span class="op">(</span><span class="va">d_tree</span>,</span>
<span>                       type  <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                       extra <span class="op">=</span> <span class="fl">101</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:chonedecisiontree"></span>
<img src="01-AnalyticsAndSportsBusinessStrategy_files/figure-html/chonedecisiontree-1.png" alt="Decision tree example" width="672"><p class="caption">
Figure 1.9: Decision tree example
</p>
</div>
<p>This tree (figure <a href="chapter1.html#fig:chonedecisiontree">1.9</a>) is simple to read. In the top node, there are 2,564 people that did not renew (nr) and over 11,300 that did renew. The first split separates people that live more than 49 miles from the park. Of those people, 906 did not renew and 663 did renew. The third split separates people who live more than 67 miles from the park. Of those that live more than 67 miles from the park, 515 did not renew.</p>
<p>A decision tree performs splits in one of multiple ways and there are lots of resources that can illustrate the methods. At this stage, the main thing to understand is that the nodes are more similar to each other than to other nodes. Each node is more homogeneous.</p>
<p>This is machine learning at its most simple form. A set of cascading questions split in formulaic ways classifies a response variable. While methods differ, at their heart many machine learning processes are very similar.</p>
</div>
</div>
<div id="automation-and-integration" class="section level3" number="1.2.4">
<h3>
<span class="header-section-number">1.2.4</span> Automation and Integration<a class="anchor" aria-label="anchor" href="#automation-and-integration"><i class="fas fa-link"></i></a>
</h3>
<p>After you have developed some basic B.I. and analytics capabilities you’ll quickly want to find ways to put them to work. Ad hoc analytics has it’s place, but to truly reap the rewards of your work you are going to need build a machine that allows you to automate some of the story telling. This is where analytics intersects I.T. work. operationalizing your analytics procedures requires a little different knowledge set. There are also different approaches.</p>
<p>I fully expect a large component of analytics work (especially the automaton and integration work) to be heavily commoditized in the future. AWS and Google have taken huge strides in building frameworks that natively integrate analytics into your DBMS. Gone are the days of writing SQL wrappers for some R or python script sitting on some server in the basement. Let’s take the same simple approach to explaining what I mean here.</p>
<p>These two functions (Automation and Integration) are mostly self-explanatory. Automation refers to removing human interaction. Integration refers to operationalizing your outputs by extending your data into commerce engines.</p>
<p>Automating procedures provides several benefits:</p>
<ul>
<li>It is a labor multiplier</li>
<li>It enables more strategic thought to go into staffing decisions</li>
<li>It keeps reports up-to-date</li>
</ul>
<p>Automation relies on a number of interlocked technologies and is more related to data engineering and an information technology group.</p>
<p>Integration refers to two elements:</p>
<ul>
<li>Integrating solutions across your organization</li>
<li>Integrating with third parties to extend capabilities</li>
</ul>
<p>Interestingly, integrating with third parties is the easy part. Integrating solutions internally is much more difficult. This typically requires change management and a sponsor in the upper levels of management.</p>
<p>Figure <a href="chapter1.html#fig:dataautomation">1.10</a> demonstrates a simplified version of the entire process from data sources all the way to the feedback loop you are creating with your marketing channel partners. When we refer to marketing channel partners, we could be referring to Google’s add network, Facebook, or many others.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:dataautomation"></span>
<img src="images/Ch1_automation.png" alt="Operationalizing analytical procedures" width="100%"><p class="caption">
Figure 1.10: Operationalizing analytical procedures
</p>
</div>
<p>While these features used to be fairly distinct, new technologies are making it much easier to link all of these activities together in one system. As someone leading these efforts, your job will be to think of how your are applying these measures instead of how to accomplish them. Additionally, we are focused on the tech here. Content creation, collateral, timing, verbiage, budgets, and many other considerations all impact automation and integration. For instance, before you distribute to a channel you’ll need to have artwork created, have a clear message and call to action, a website may need to be updated, and other communication may have to be considered. Nothing is ever easy.</p>
</div>
</div>
<div id="key-performance-indicators" class="section level2" number="1.3">
<h2>
<span class="header-section-number">1.3</span> Key Performance Indicators<a class="anchor" aria-label="anchor" href="#key-performance-indicators"><i class="fas fa-link"></i></a>
</h2>
<p>This section will explain an application of a KPI. This piece of feedback is critical for understanding how well you are performing (typically against some arbitrary or historic benchmark). I’ll also refer back to an earlier paragraph when we talked about the stock market. Analytics is contextual. What is a KPI? A KPI is a figure that links business performance to some desired outcome. For instance, in Baseball the number of walks a player takes is a KPI that will likely help predict on-base-percentage. Analytics groups might be able to link On-base-percentage to wins. If you are in the market for a player, you might weight walks more heavily than other metrics. on-base-percentage might be a KPI and walks might be the key to increasing on-base-percentage leading to more wins. The following paragraphs will discuss and criticize the most commonly used KPI at clubs: Percap, or average price paid per ticket.</p>
<p>Analytics work must be tempered with industry knowledge; it must be put into the correct context. It is easy to make incorrect judgments when armed with the blunt instrument of data. <strong>Per-Cap</strong> (or average ticket price) is likely the worst. Per-Cap is a commonly used KPI that is used for comparing the effectiveness of sales and pricing strategy and is simply the average price of a sold ticket:</p>
<p><span class="math display">\[\begin{equation} TotalTicketRevenue / NumberOfSeatsSold \end{equation}\]</span></p>
<p>On the surface, this metric seems interesting. However, there are a number of issues with it:</p>
<ol style="list-style-type: decimal">
<li>The denominator changes for every game that is not sold out. In this case, you are comparing fractions with different denominators. The mix of tickets could vary wildly from game-to-game. This alters interpretation and leads to issue number two.</li>
<li>The number becomes diluted and tends to decrease when more tickets are sold. As more tickets are sold, more less-expensive tickets are sold and this tends to drive down the per-cap. Is a high per-cap good? The answer is that it depends. Let’s illustrate what I mean:</li>
</ol>
<p><span class="math display">\[\begin{equation} \$1,400,000 Ticket Revenue / 34,000 Tickets sold = \$41.80 \end{equation}\]</span>
<span class="math display">\[\begin{equation} \$1,600,000 Ticket Revenue / 40,000 Tickets sold = \$40.00 \end{equation}\]</span></p>
<p>How do you reconcile the $1.80 difference in per-cap? Does the higher number indicate that you priced more efficiently under the lower revenue scenario? The answer depends on many factors. Taken alone, this number doesn’t have much meaning. A better metric is <em>Yield</em>. Yield is just as simple:</p>
<p><span class="math display">\[\begin{equation} TotalTicketRevenue / AvailableTickets \end{equation}\]</span></p>
<p>Yield is more intuitive and increases with every sale since it isn’t penalized by unsold inventory. What does the previous example look like from a yield perspective?</p>
<p><span class="math display">\[\begin{equation} \$1,400,000 Ticket Revenue / 40,000 Available Tickets = \$35.00 \end{equation}\]</span>
<span class="math display">\[\begin{equation} \$1,600,000 Ticket Revenue / 40,000 Available Tickets = \$40.00 \end{equation}\]</span></p>
<p>Yield is higher when revenue is higher now that we hold the denominator constant. Hopefully, this indicates that we were more efficient at selling our seats or perhaps demand at higher prices buoyed up revenue. This number is much easier to interpret and to leverage for hypothesis testing. The easiest way to consider this metric is to visualize it. A simple scatter plot (figure <a href="chapter1.html#fig:chonepercapgraph">1.11</a>) does the trick. In a real life scenario average ticket price isn’t highly correlated to overall revenue until games begin to approach a sellout and percap approximates yield.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#-----------------------------------------------------------------</span></span>
<span><span class="co"># percap scatter plot</span></span>
<span><span class="co">#-----------------------------------------------------------------</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">714</span><span class="op">)</span></span>
<span><span class="va">percap_data</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  percap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">81</span>,<span class="fl">40</span>,<span class="fl">10</span><span class="op">)</span>,</span>
<span>  revenue <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">81</span>,<span class="fl">1000000</span>,<span class="fl">200000</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">x_label</span>  <span class="op">&lt;-</span> <span class="op">(</span><span class="st">'\n Percap'</span><span class="op">)</span></span>
<span><span class="va">y_label</span>  <span class="op">&lt;-</span> <span class="op">(</span><span class="st">'Revenue \n'</span><span class="op">)</span></span>
<span><span class="va">title</span>    <span class="op">&lt;-</span> <span class="op">(</span><span class="st">'Revenue vs. Percap'</span><span class="op">)</span></span>
<span><span class="va">scatter_percap</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data  <span class="op">=</span> <span class="va">percap_data</span>, </span>
<span>                  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">percap</span>, </span>
<span>                      y <span class="op">=</span> <span class="va">revenue</span><span class="op">)</span><span class="op">)</span>                   <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.9</span>, color <span class="op">=</span> <span class="st">'dodgerblue'</span><span class="op">)</span>        <span class="op">+</span></span>
<span>  <span class="fu">geom_rug</span><span class="op">(</span>color <span class="op">=</span> <span class="st">'coral'</span><span class="op">)</span>                           <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>label <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/dollar_format.html">dollar</a></span><span class="op">)</span>          <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>label <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/dollar_format.html">dollar</a></span><span class="op">)</span>          <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="va">x_label</span><span class="op">)</span>                                       <span class="op">+</span> </span>
<span>  <span class="fu">ylab</span><span class="op">(</span><span class="va">y_label</span><span class="op">)</span>                                       <span class="op">+</span> </span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="va">title</span><span class="op">)</span>                                      <span class="op">+</span></span>
<span>  <span class="va">graphics_theme_1</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:chonepercapgraph"></span>
<img src="images/ch1_percap.png" alt="Scatterplot of revenue and percap" width="100%"><p class="caption">
Figure 1.11: Scatterplot of revenue and percap
</p>
</div>
<p>Another poor metric that is often used is <strong>Sales on or by date</strong>. This metric asks how many sales I had on a particular date in a previous year. This metric may be the biggest liar out of any commonly used KPI. This metric can be fraught with distortion in baseball because of the schedule. It likely has more validity when a sport has fewer games or has a higher FSE base. FSE stands for <em>Full Season Equivalent</em> and represents the number of tickets that are sold to individuals on a season (or modified season) basis.</p>
<p><em>Sales by date</em> is problematic for a few different reasons:</p>
<ol style="list-style-type: decimal">
<li>If you are comparing yourself to a different team it doesn’t consider the admixture of tickets. A team with 20,000 FSEs will look dramatically different than a team with 6,000 FSEs.</li>
<li>Once your schedule has begun, the admixture of games will have significant influence on the outcomes. What does this mean?</li>
</ol>
<p>We’ll see in chapter <a href="chapter6.html#chapter6">6</a> which elements will have the biggest influence on ticket sales. Sales-by-date doesn’t really consider game dates, opponents, on-field-success, seasonality, game times, etc. Additionally, people choose to purchase tickets at different times and for different reasons. Because of these differences, sales of a specific ticket class may look great after the first twenty games, but terrible after the first forty games. Take a look at the line graph in chapter <a href="chapter3.html#chapter3">3</a> <a href="chapter3.html#fig:chthreeticketsline">3.6</a>. If you built a cumulative line for each of these lines the results would look very different. Don’t benchmark off of sales-by-date. Instead, leverage forecasts that consider the underlying elements of the schedule. Let’s consider a simple example (figure: <a href="chapter1.html#fig:salary">1.12</a>). This illustration was created with publicly available data and we’ll demonstrate how to create it a little later.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:salary"></span>
<img src="images/ch1_salary.png" alt="Relationship to avg salary and ticket sales" width="100%"><p class="caption">
Figure 1.12: Relationship to avg salary and ticket sales
</p>
</div>
<p>There certainly appears to be some relationship between the average salary of a player and the total number of tickets sold. The relationship might even be stronger for teams in larger markets. Why is this the case? This top-down approach to forecasting demonstrates that the amount that players are paid (or if a few players are paid a lot of money) that ticket sales tend to be higher. We aren’t seeing tight clusters based on market size. Higher pay may demonstrate better performance. Better performance might translate into more wins. More wins attracts more earned media and more fans. Ticket sales increase.</p>
<p>This is an obtuse example, but it demonstrates the point. There are underlying mechanisms that likely do a reasonable job of explaining ticket sales. We didn’t even cover bottom-up forecasting elements such as marketing efforts!</p>
<p>The point of this section should now be clear. Performance is dictated by any number of factors. Some are within your control, some are not. Running a team is similar to running a hedge fund. Sometimes it’s up, sometimes it’s down. However, you need to understand why it’s up or down so that you can make smarter decisions. Bad KPIs don’t help you make smarter decisions. Leveraging appropriate KPIs has many salutary impacts and good analytics always looks for the underlying mechanism at work.</p>
</div>
<div id="why-do-people-buy-tickets-to-sporting-events" class="section level2" number="1.4">
<h2>
<span class="header-section-number">1.4</span> Why do people buy tickets to sporting events?<a class="anchor" aria-label="anchor" href="#why-do-people-buy-tickets-to-sporting-events"><i class="fas fa-link"></i></a>
</h2>
<p>Sports fandom is irrational. This irrationality can make sports challenging and infuriating to work with from an analytics perspective. How can we determine if our marketing efforts are making a difference? Are we simply slaves to the whims and fancy of the mob? The answer is complex and we will explore it in our chapter on forecasting and pricing, chapter <a href="chapter6.html#chapter6">6</a>. Additionally, the answer may (to a degree) exist in our genes.</p>
<blockquote>
<p>“We have the ability (Under special conditions) to trancend self-interest and lose ourselves (temporarily and ecstatically) in something larger than ourselves.”</p>
<p>— Johnathan Haidt, “The Riteous Mind”</p>
</blockquote>
<p>This is an interesting quote from “The Righteous Mind” <span class="citation">(<a href="references.html#ref-Haidt2012" role="doc-biblioref">Haidt 2012</a>)</span>. Humans are programmed to participate in groups. Maybe some people buy tickets because they are lonely, or bored. If these mechanisms such as the “need to belong” are driving some sports fandom, perhaps they can be manipulated. Perhaps they are being manipulated. Ultimately, there are lot’s of reasons why someone might buy tickets to a sporting event:</p>
<ul>
<li>They buy them for their business</li>
<li>They just want something to do</li>
<li>They have brand loyalty driven by upbringing</li>
<li>They are motivated to associate themselves with a winning group</li>
<li>They genuinely like and appreciate the sport</li>
<li>They feel good when they come to a game</li>
<li>They want something to do with their family</li>
</ul>
<p>There are also brand components associated with history and logos. This one is interesting. We’ve recently seen some teams abandon logos and nicknames in response to societal or corporate pressure. <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://www.espn.com/mlb/story/_/id/31868331/cleveland-changing-name-indians-guardians" class="uri"&gt;https://www.espn.com/mlb/story/_/id/31868331/cleveland-changing-name-indians-guardians&lt;/a&gt;&lt;/p&gt;'><sup>17</sup></a> What does this mean in an analytics context? How much is a brand worth? Obviously, brand equity must be considered. This is at least partially what drives corporate sponsorship. Borrowed equity by associating your brand with another brand with a positive image is fundamental to a major revenue driver for clubs. Brand value might be calculated using one of several techniques such as the <em>Royalty Relief Method</em>. <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://en.wikipedia.org/wiki/Brand_valuation" class="uri"&gt;https://en.wikipedia.org/wiki/Brand_valuation&lt;/a&gt;&lt;/p&gt;'><sup>18</sup></a> branding is a big deal and brands have value.</p>
<p>There could be any number of answers to the question of why someone might purchase tickets to a baseball, football, basketball, hockey, or soccer game. People in the United States and across the world have complex emotional relationships with sports and brands. These emotions may do a better job of explaining their behavior than a model predicting likelihood to purchase.</p>
<p>This side of sports marketing is often overlooked and under-served. Behavioral economics is a huge field and there is a lot of literature on these subjects. “The Power of Moments” <span class="citation">(<a href="references.html#ref-Heath2017" role="doc-biblioref">Chip Heath 2017</a>)</span> is an outstanding book that is imminently useful if one was to consider how specific mechanisms engender loyalty. Major themes such as <em>pride</em> and <em>connection</em> are almost instantly accessible to marketers at the club level. How can an analyst help drive the desired outcomes? The answer may depend on solutions that may not be in the wheelhouse of a data scientist or business analyst.</p>
</div>
<div id="key-concepts-and-chapter-summary" class="section level2" number="1.5">
<h2>
<span class="header-section-number">1.5</span> Key concepts and chapter summary<a class="anchor" aria-label="anchor" href="#key-concepts-and-chapter-summary"><i class="fas fa-link"></i></a>
</h2>
<p>This chapter explains some rationale for how to approach analytics and strategy at an organizational level. However, strategy is a broad term and could include many elements such as business development and hedging strategies that may include financial strategy. We focused on analytics strategy and covered a few main points related to our analytics hierarchy:</p>
<ol style="list-style-type: decimal">
<li>Technologies tangential relationship to analytics</li>
<li>Basic SQL data structures and the importance of data integrity</li>
<li>Business Intelligence</li>
<li>Analytics</li>
<li>Automation and Integration</li>
<li>Key performance indicators</li>
<li>Behavioral economics</li>
</ol>
<p>Ultimately, this chapter only serves to give a very high-level overview of considerations around <em>analytics</em> and business strategy:</p>
<ul>
<li>Technology isn’t analytics. It is a tool that serves it and other business functions. Don’t consider technology in a vacuum.</li>
<li>You now understand some basics about data structure and databases. You have to start here. Without good data, your project is going nowhere. You’ll want to acquire some knowledge of SQL or you are going to be limited in your capability.</li>
<li>Business Intelligence tends to focus on reporting and research. You’ll likely begin with descriptive reports and as your organization matures become more forward looking by incorporating analytics functions.</li>
<li>Analytics mostly focuses on trying to guess future outcomes. There are a variety of regression and machine learning tools at your disposal. These tools have been commoditized over the past couple of decades. This world is much easier to navigate than it was even ten years ago.</li>
<li>Automating tasks is a force-multiplier. There is currently an arms race going on between big-tech companies as they continue to bolster their analytics and database systems. The Google Cloud Platform and Amazon Web Services are two key examples. They have hundreds of tools between them for consuming, manipulating, and deploying data.</li>
<li>The most difficult part of determining KPIs is probably agreeing on what they are. Some KPI are easy. For instance, NOI or revenue-per-square-foot might be great KPIs if you are dealing with real-estate. However, they may not be. KPIs are contextual.</li>
<li>People do things for different reasons. Modeling consumer behavior is difficult, but plays a major role in sports. We only touched on Behavioral Economics, but rounding out your analytics toolbox with some reading in this field is highly recommended.</li>
</ul>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="index.html">Abstract and forward</a></div>
<div class="next"><a href="chapter2.html"><span class="header-section-number">2</span> Constructing our data sets</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#chapter1"><span class="header-section-number">1</span> Analytics and sports business strategy</a></li>
<li><a class="nav-link" href="#understanding-the-meaning-of-strategy"><span class="header-section-number">1.1</span> Understanding the meaning of strategy</a></li>
<li>
<a class="nav-link" href="#technologies-place-in-strategy-and-analytics"><span class="header-section-number">1.2</span> Technologies place in strategy and analytics</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#data"><span class="header-section-number">1.2.1</span> Data</a></li>
<li><a class="nav-link" href="#business-intelligence"><span class="header-section-number">1.2.2</span> Business Intelligence</a></li>
<li><a class="nav-link" href="#analytics"><span class="header-section-number">1.2.3</span> Analytics</a></li>
<li><a class="nav-link" href="#automation-and-integration"><span class="header-section-number">1.2.4</span> Automation and Integration</a></li>
</ul>
</li>
<li><a class="nav-link" href="#key-performance-indicators"><span class="header-section-number">1.3</span> Key Performance Indicators</a></li>
<li><a class="nav-link" href="#why-do-people-buy-tickets-to-sporting-events"><span class="header-section-number">1.4</span> Why do people buy tickets to sporting events?</a></li>
<li><a class="nav-link" href="#key-concepts-and-chapter-summary"><span class="header-section-number">1.5</span> Key concepts and chapter summary</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/Justin-Watkins/Justin-Watkins.github.io/blob/main/01-AnalyticsAndSportsBusinessStrategy.md">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/Justin-Watkins/Justin-Watkins.github.io/edit/main/01-AnalyticsAndSportsBusinessStrategy.md">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Fundamentals of Sports Business Analytics and Strategy</strong>" was written by Justin Watkins. It was last built on 2022-12-19.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
